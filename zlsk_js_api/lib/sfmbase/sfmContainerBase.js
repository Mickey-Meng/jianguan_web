!function(n,e){if("undefined"!=typeof module&&module.exports){var i=require("jquery"),t=require("underscore"),o=require("SfmModuleBase");module.exports=n(i,t,o)}else"function"==typeof define&&define.amd?define(["jquery","underscore","sfmModuleBase"],n):(null==e.SFM&&(e.SFM={}),e.SFM.SfmContainerBase=n(e.$,e._,e.SFM.SfmModuleBase))}(function(c,n,e){return e.extend({constructor:function(n){this.base(n)},destroy:function(){this.base()},render:function(){return this.__initContainer__().__initCD__().resize(),this.base(),this},resize:function(){return this},getContainer:function(n){var e=this,i=e.getSfmUtil().valueOrDefault,t=i(n,"type",null),o=i(n,"region",null),r=i(n,"id",null),l=i(n,"available",!0),u=e._containerDesc;if(!t||!o||!u)return null;var a=e.__findContainer__(n);if(!a)return null;if(r)return a;if(a.cid&&a.container&&l&&e.closeContainer({id:a.cid}),!a.cid||!a.container){var f=a.id+"_"+e.getSfmUtil().fguid()+"_"+(new Date).getTime(),d=null==a.width?"100%":a.width+"px",_=null==a.height?"100%":a.height+"px",s=c('<div id="'+f+'"></div>');s.css("width",d).css("height",_).addClass("sfm-f-viewContainer"),s.appendTo(e._el.find("#"+a.id)),a.cid=f,a.container=s,a.state|=1}return null==a.count&&(a.count=0),a.count++,a},showContainer:function(n,e){var i=this,t={};c.extend(!0,t,e,{available:!1});var o=i.getSfmUtil().valueOrDefault,r=i.__findContainer__(t);if(r&&r.container){var l=n?"onShow":"onHide",u=n?"onShown":"onHidden",a=r[l]||o(e,l,null),f=i.__getCtnrInfo__(r);"function"==typeof a&&a(f),n?r.container.show():r.container.hide();var d=r[u]||o(e,u,null);"function"==typeof d&&d(f)}},openContainer:function(n){var e=this,i=e.getContainer(n);if(!i)return e;var t=e.getSfmUtil().valueOrDefault,o=i.onOpen=t(n,"onOpen",null);i.onOpened=t(n,"onOpened",null),i.onClose=t(n,"onClose",null),i.onClosed=t(n,"onClosed",null),i.onShow=t(n,"onShow",null),i.onShown=t(n,"onShown",null),i.onHide=t(n,"onHide",null),i.onHidden=t(n,"onHidden",null);var r=e.__getCtnrInfo__(i);return"function"==typeof o&&o(r),"function"==typeof i.onOpened&&i.onOpened(r),e},closeContainer:function(n){var e=this,i=e.getSfmUtil().valueOrDefault,t=i(n,"type",null),o=(i(n,"region",null),i(n,"id",null)),r=(i(n,"available",!0),e._containerDesc);if(r&&o)for(var l in r)if(!t||t==l)for(var u=0;u<r[l].length;u++){var a=r[l][u];if(a.cid==o){var f=a.onClose;"function"==typeof f&&f(e.__getCtnrInfo__(a)),a.container&&(a.container.remove(),delete a.container,0<a.count&&a.count--);var d=a.onClosed;"function"==typeof d&&d(e.__getCtnrInfo__(a)),a.state&=0}}},__initContainer__:function(){return this._el=c("body"),this},__initCD__:function(){return this._containerDesc={},this},__findContainer__:function(n){var e=this.getSfmUtil().valueOrDefault,i=e(n,"type",null),t=e(n,"region",null),o=e(n,"id",null),r=e(n,"available",!0),l=this._containerDesc;if(!i||!t||!l)return null;var u=i.split(","),a=t.split(",");for(var f in l)for(var d=0;d<u.length;d++)if(f==u[d])for(var _=0;_<l[f].length;_++)for(var s=0;s<a.length;s++){var c=l[f][_];if(c.region==a[s])if(o){if(o==c.cid)return c}else if(!r||0==(1&l[f][_].state))return c}return null},__findContainerByCid__:function(n,e,i){var t=this._containerDesc;if(!t||!n)return null;for(var o in t)if(!e||o==e)for(var r=0;r<t[o].length;r++){var l=t[o][r];if((!i||i==l.region)&&l.cid==n)return l}return null},__getCtnrInfo__:function(n){var e={};for(var i in n)"id"!=i&&"function"!=typeof n[i]&&("cid"==i&&(e.id=n[i]),e[i]=n[i]);return e},__className__:"SfmContainerBase"})},window);
