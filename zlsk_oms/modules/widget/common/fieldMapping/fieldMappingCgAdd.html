<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>添加分组</title>
    <link rel="stylesheet" href="../../../../lib/ok_admin/css/okadmin.css">
    <script type="text/javascript" src="../../../../lib/ok_admin/lib/layui/layui.js"></script>
    <style>
        .layui-form-selectup dl {
            bottom: auto;
        }
    </style>
</head>
<body>
<div class="layui-body commonOutCss" style="left: 0" id="content">
    <form class="layui-form layui-form-pane ok-form" style="overflow: auto" lay-filter="config">
        <div class="layui-input-inline">
            <label class="layui-form-label">分组key</label>
            <div class="layui-input-block">
                <input type="text" name="key" placeholder="分组key" autocomplete="off" class="layui-input" style="width: 212px">
            </div>
        </div>
        <div class="layui-input-inline" id="defaultConfig" >
            <label class="layui-form-label">是否默认配置</label>
            <div class="layui-input-block">
                <select name="fdef" lay-filter="type" id="select" style="overflow: auto">
                    <option value="0">否</option>
                    <option value="1">是</option>
                </select>
            </div>
        </div>
        <div style="text-align: center">
            <button class="layui-btn" lay-submit lay-filter="add" id="add">立即提交</button>
        </div>
    </form>
</div>
<script>
    var $;

    var formData;
    function initForm(data) {
        formData = JSON.parse(data);
    }
    layui.use([ "form",  "okLayer", "layer", "okUtils", 'constantUrl'], function() {
        var form = layui.form;
        var layer = layui.layer;
        var okUtils = layui.okUtils;
        var constantUrl = layui.constantUrl;
        var isAdd = okUtils.getUrlParameter('isAdd');
        var gid = okUtils.getUrlParameter('gid');
        form.val('config',formData);
        form.on('submit(add)',function (data) {
            let param  = data.field;
            let url = constantUrl.stMap.updateDataPsCg;
            if (isAdd === 'true'){
                url = constantUrl.stMap.insertDataPsCg;
            }else {
                param.gid = gid;
            }
            okUtils.ajax({
                'url': url,
                'param':param
            }).done(function (data1) {
                if (data1.meow === 0){
                    parent.parentFlag = 1;
                    parent.layer.close(parent.layer.getFrameIndex(window.name));
                }else {
                    layer.alert('警告 添加数据失败');
                }
            });
            return false;
        })
    })
</script>
</body>
</html>
